目前白板

![image-20220705232127073](D:\c++Short\MyPro\images\image-20220705232127073.png)

# 后期任务



***先完成无限和竞速模式的正常化再想其他的***。



`view`: 

> 绘制方块池（网格线），
>
> `next`(网格线)，
>
> `hold`（网格线）
>
> 添加消行数`Label`
>
> 设计排行榜窗口，对应调用显示函数再议
>
> 调整窗口`size`，现在过于细长，稍微短点
>
> 
>
> `common`中会补充`notification`类，在`view`设计层构造，`model \ viewmodel`进行调用，即只有在数据更新，调用`notification`方法时才刷新界面，界面不再使用独立定时器刷新。
>
> 网格线也可以用`painter`，刷新时相当于调用`repaint`即可重绘游戏池，游戏状态数据使用`settext`即可.
>
> 
>
> 开始按钮没显示……
>
> 先搞定所有正常显示，再考虑美感……



`model \ viewmodel`:

>**！！**：补充开始游戏的函数，提供给view层。
>
>游戏状态置 " 运行中 "（游戏状态成员已添加进`model`，可用0~N表示各种状态，暂停、运行……）
>
>`QTimer`在`model`构造函数中构造，有`start`和`stop`函数分别开始和停止，在游戏开始函数中初始化刷新频率（无限模式的加速需要改变刷新频率、竞速应该不用）
>
>`QTimer`绑定运行函数，游戏开始
>
>**！！**：补充运行函数，
>
>目前的`down`函数是不够的，至少需要补充结束判定（死亡和通过），考虑到两种模式的结束机制。
>
>`down`后调用`notification`方法（待实现）通知`view`进行更新。
>
>
>
>补充旋转函数等其余功能函数
>
>



# 整改

1. `command.h`内删除`viewmodel.h`的包含，仅进行`viewmodel`类的定义。具体使用在`command.cpp`内进行包含。
2. `model.h`增加数据项（`score \ time \ gameMode \ gameState...`），部分向外传递。
3. `viewmodel.h`中增加数据传递函数向`view`层传递数据(`times \ linenum \ score`)。

4. `view.h`增加数据指针及设置函数。
5. `model`层设置`start`函数用于开始游戏……具体再看

……

各种`bug`：`pro`文件、未定义函数、变量……





# 存疑

1. 定时器管理……（何时启动、何时关闭）





